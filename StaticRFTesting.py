#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Sat Nov 21 19:53:27 2020

@author: hallavar
"""

import joblib
from common import load_firstlayer_data, get_metrics
from Graphics import make_confusion_matrix


Istlayer_dataset_path = "../Datasets/API-Intent-Traffic/Other_CSVs/1st_Layer/"

test_samples, test_labels=load_firstlayer_data(Istlayer_dataset_path, data='Testing')

rf = joblib.load("./RFOptiStochastic.joblib")

predictions= rf.predict(test_samples)

cm, accuracy, precision, recall, f1 = get_metrics(test_labels, predictions)

categories=['Benign', 'Malware']
labels = ['True Neg','False Pos','False Neg','True Pos']

make_confusion_matrix(cm, 
                      group_names=labels,
                      categories=categories, 
                      cmap='binary',
                      sklearn_matrix=True)